[["mlr.html", "Chapter 9 Multiple Linear Regression", " Chapter 9 Multiple Linear Regression Hopefully by now you have some motivation for why we need to have a robust model that can incorporate information from multiple variables at the same time. Multiple linear regression is our tool to expand our MODEL to better fit the DATA. Extends simple linear regression. Describes a linear relationship between a single continuous \\(Y\\) variable, and several \\(X\\) variables. Predicts \\(Y\\) from \\(X_{1}, X_{2}, \\ldots , X_{P}\\). X’s can be continuous or discrete (categorical) X’s can be transformations of other X’s, e.g., \\(log(x), x^{2}\\). Now it’s no longer a 2D regression line, but a \\(p\\) dimensional regression plane. This section uses functions from the dotwhisker and gtsummary visualize results from multiple regression models. "],["mathematical-model-1.html", "9.1 Mathematical Model", " 9.1 Mathematical Model The mathematical model for multiple linear regression equates the value of the continuous outcome \\(y_{i}\\) to a linear combination of multiple predictors \\(x_{1} \\ldots x_{p}\\) each with their own slope coefficient \\(\\beta_{1} \\ldots \\beta_{p}\\). \\[ y_{i} = \\beta_{0} + \\beta_{1}x_{1i} + \\ldots + \\beta_{p}x_{pi} + \\epsilon_{i}\\] where \\(i\\) indexes the observations \\(i = 1 \\ldots n\\), and \\(j\\) indexes the number of parameters \\(j=1 \\ldots p\\). This linear combination is often written using summation notation: \\(\\sum_{i=1}^{p}X_{ij}\\beta_{j}\\). The assumptions on the residuals \\(\\epsilon_{i}\\) still hold: They have mean zero They are homoscedastic, that is all have the same finite variance: \\(Var(\\epsilon_{i})=\\sigma^{2}&lt;\\infty\\) Distinct error terms are uncorrelated: (Independent) \\(\\text{Cov}(\\epsilon_{i},\\epsilon_{j})=0,\\forall i\\neq j.\\) In matrix notation the linear combination of \\(X\\)’s and \\(\\beta\\)’s is written as \\(\\mathbf{x}_{i}^{&#39;}\\mathbf{\\beta}\\), (the inner product between the vectors \\(\\mathbf{x}_{i}\\) and \\(\\mathbf{\\beta}\\)). Then the model is written as: \\[ \\textbf{y} = \\textbf{X} \\mathbf{\\beta} + \\mathbf{\\epsilon} ,\\] and we say the regression model relates \\(y\\) to a function of \\(\\textbf{X}\\) and \\(\\mathbf{\\beta}\\), where \\(\\textbf{X}\\) is a \\(nxp\\) matrix of \\(p\\) covariates on \\(n\\) observations and \\(\\mathbf{\\beta}\\) is a length \\(p\\) vector of regression coefficients. Note: Knowledge of Matricies or Linear Algebra is not required to conduct or understand multiple regression, but it is foundational and essential for Statistics and Data Science majors to understand the theory behind linear models. Learners in other domains should attempt to understand matricies at a high level, as some of the places models can fail is due to problems doing math on matricies. "],["parameter-estimation.html", "9.2 Parameter Estimation", " 9.2 Parameter Estimation Recall the goal of regression analysis is to minimize the unexplained/residual error. That is, to minimize the difference between the value of the dependent variable predicted by the model and the true value of the dependent variable. \\[ \\hat{y_{i}} - y_{i}, \\] where the predicted values \\(\\hat{y}_{i}\\) are calculated as \\[\\hat{y}_{i} = \\sum_{i=1}^{p}X_{ij}\\beta_{j}\\] The sum of the squared residual errors (the distance between the observed point \\(y_{i}\\) and the fitted value) now has the following form: \\[ \\sum_{i=1}^{n} |y_{i} - \\sum_{i=1}^{p}X_{ij}\\beta_{j}|^{2}\\] Or in matrix notation \\[ || \\mathbf{Y} - \\mathbf{X}\\mathbf{\\beta} ||^{2} \\] Solving this least squares problem for multiple regression requires knowledge of multivariable calculus and linear algebra, and so is left to a course in mathematical statistics. "],["mlr-fev.html", "9.3 Example", " 9.3 Example The analysis in example 7.5 concluded that FEV1 in fathers significantly increases by 0.12 (95% CI:0.09, 0.15) liters per additional inch in height (p&lt;.0001). Looking at the multiple \\(R^{2}\\) (correlation of determination), this simple model explains 25% of the variance seen in the outcome \\(y\\). However, FEV tends to decrease with age for adults, so we should be able to predict it better if we use both height and age as independent variables in a multiple regression equation. What direction do you expect the slope coefficient for age to be? For height? Fitting a regression model in R with more than 1 predictor is done by adding each variable to the right hand side of the model notation connected with a +. mlr.dad.model &lt;- lm(FFEV1 ~ FAGE + FHEIGHT, data=fev) summary(mlr.dad.model) ## ## Call: ## lm(formula = FFEV1 ~ FAGE + FHEIGHT, data = fev) ## ## Residuals: ## Min 1Q Median 3Q Max ## -1.34708 -0.34142 0.00917 0.37174 1.41853 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -2.760747 1.137746 -2.427 0.0165 * ## FAGE -0.026639 0.006369 -4.183 4.93e-05 *** ## FHEIGHT 0.114397 0.015789 7.245 2.25e-11 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.5348 on 147 degrees of freedom ## Multiple R-squared: 0.3337, Adjusted R-squared: 0.3247 ## F-statistic: 36.81 on 2 and 147 DF, p-value: 1.094e-13 confint(mlr.dad.model) ## 2.5 % 97.5 % ## (Intercept) -5.00919751 -0.51229620 ## FAGE -0.03922545 -0.01405323 ## FHEIGHT 0.08319434 0.14559974 Interpretations Holding height constant, a father who is one year older is expected to have a FEV value 0.03 (0.01, 0.04) liters less than another man (p&lt;.0001). Holding age constant, a father who is 1cm taller than another man is expected to have a FEV value of 0.11 (.08, 0.15) liter greater than the other man (p&lt;.0001). For the model that includes age, the coefficient for height is now 0.11, which is interpreted as the rate of change of FEV1 as a function of height after adjusting for age. This is also called the partial regression coefficient of FEV1 on height after adjusting for age. Both height and age are significantly associated with FEV in fathers (p&lt;.0001 each). "],["presenting-regression-results.html", "9.4 Presenting regression results", " 9.4 Presenting regression results The direct software output always tells you more information than what you are wanting to share with an audience. Here are some ways to “prettify” your regression output. Using tidy and kable broom::tidy(mlr.dad.model) |&gt; kable(digits=3) term estimate std.error statistic p.value (Intercept) -2.761 1.138 -2.427 0.016 FAGE -0.027 0.006 -4.183 0.000 FHEIGHT 0.114 0.016 7.245 0.000 Using gtsummary library(gtsummary) tbl_regression(mlr.dad.model) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #iydbaessff .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #iydbaessff .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iydbaessff .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #iydbaessff .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #iydbaessff .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iydbaessff .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iydbaessff .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #iydbaessff .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #iydbaessff .gt_column_spanner_outer:first-child { padding-left: 0; } #iydbaessff .gt_column_spanner_outer:last-child { padding-right: 0; } #iydbaessff .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #iydbaessff .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #iydbaessff .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #iydbaessff .gt_from_md > :first-child { margin-top: 0; } #iydbaessff .gt_from_md > :last-child { margin-bottom: 0; } #iydbaessff .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #iydbaessff .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #iydbaessff .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #iydbaessff .gt_row_group_first td { border-top-width: 2px; } #iydbaessff .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iydbaessff .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #iydbaessff .gt_first_summary_row.thick { border-top-width: 2px; } #iydbaessff .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iydbaessff .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iydbaessff .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #iydbaessff .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #iydbaessff .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iydbaessff .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iydbaessff .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #iydbaessff .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iydbaessff .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #iydbaessff .gt_left { text-align: left; } #iydbaessff .gt_center { text-align: center; } #iydbaessff .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #iydbaessff .gt_font_normal { font-weight: normal; } #iydbaessff .gt_font_bold { font-weight: bold; } #iydbaessff .gt_font_italic { font-style: italic; } #iydbaessff .gt_super { font-size: 65%; } #iydbaessff .gt_two_val_uncert { display: inline-block; line-height: 1em; text-align: right; font-size: 60%; vertical-align: -0.25em; margin-left: 0.1em; } #iydbaessff .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #iydbaessff .gt_asterisk { font-size: 100%; vertical-align: 0; } #iydbaessff .gt_slash_mark { font-size: 0.7em; line-height: 0.7em; vertical-align: 0.15em; } #iydbaessff .gt_fraction_numerator { font-size: 0.6em; line-height: 0.6em; vertical-align: 0.45em; } #iydbaessff .gt_fraction_denominator { font-size: 0.6em; line-height: 0.6em; vertical-align: -0.05em; } Characteristic Beta 95% CI1 p-value FAGE -0.03 -0.04, -0.01 FHEIGHT 0.11 0.08, 0.15 1 CI = Confidence Interval Using dwplot from the dotwhisker package to create a forest plot. library(dotwhisker) dwplot(mlr.dad.model) "],["confounding.html", "9.5 Confounding", " 9.5 Confounding One primary purpose of a multivariable model is to assess the relationship between a particular explanatory variable \\(x\\) and your response variable \\(y\\), after controlling for other factors. All the ways covariates can affect response variables Credit: A blog about statistical musings Easy to read short article from a Gastroenterology journal on how to control confounding effects by statistical analysis. https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4017459/ Other factors (characteristics/variables) could also be explaining part of the variability seen in \\(y\\). If the relationship between \\(x_{1}\\) and \\(y\\) is bivariately significant, but then no longer significant once \\(x_{2}\\) has been added to the model, then \\(x_{2}\\) is said to explain, or confound, the relationship between \\(x_{1}\\) and \\(y\\). Steps to determine if a variable \\(x_{2}\\) is a confounder. Fit a regression model on \\(y \\sim x_{1}\\). If \\(x_{1}\\) is not significantly associated with \\(y\\), STOP. Re-read the “IF” part of the definition of a confounder. Fit a regression model on \\(y \\sim x_{1} + x_{2}\\). Look at the p-value for \\(x_{1}\\). One of two things will have happened. If \\(x_{1}\\) is still significant, then \\(x_{2}\\) does NOT confound (or explain) the relationship between \\(y\\) and \\(x_{1}\\). If \\(x_{1}\\) is NO LONGER significantly associated with \\(y\\), then \\(x_{2}\\) IS a confounder. This means that the third variable is explaining the relationship between the explanatory variable and the response variable. Note that this is a two way relationship. The order of \\(x_{1}\\) and \\(x_{2}\\) is invaraiant. If you were to add \\(x_{2}\\) to the model before \\(x_{1}\\) you may see the same thing occur. That is - both variables are explaining the same portion of the variance in \\(y\\). 9.5.1 Example: Does smoking affect pulse rate? Prior studies have indicate that smoking is associated with high blood pressure. Is smoking also associated with your pulse rate? First we consider the bivariate relationship between pulse rate (H4PR) and cigarette smoking as measured by the quantity of cigarettes smoked each day during the past 30 days (H4TO6). lm(H4PR ~ H4TO6 , data=addhealth) %&gt;% summary() ## ## Call: ## lm(formula = H4PR ~ H4TO6, data = addhealth) ## ## Residuals: ## Min 1Q Median 3Q Max ## -30.826 -8.548 -0.687 7.258 120.841 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 73.7702 0.4953 148.936 &lt; 2e-16 *** ## H4TO6 0.1389 0.0396 3.507 0.000464 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 12.56 on 1761 degrees of freedom ## (4741 observations deleted due to missingness) ## Multiple R-squared: 0.006936, Adjusted R-squared: 0.006372 ## F-statistic: 12.3 on 1 and 1761 DF, p-value: 0.0004644 As the number of cigarettes smoked each day increases by one, a persons pulse rate significantly increases by 0.13. However, there are more ways to assess the amount someone smokes. Consider a different measure of smoking, “during the past 30 days, on how many days did you smoke cigarettes?” (H4TO5). So here we are measuring the # of days smoked, not the # of cigarettes per day. If we include both in the model, we note that the earlier measure of smoking H4TO6 is no longer significant (at the 0.05 level). lm(H4PR ~ H4TO5 + H4TO6 , data=addhealth) %&gt;% summary() ## ## Call: ## lm(formula = H4PR ~ H4TO5 + H4TO6, data = addhealth) ## ## Residuals: ## Min 1Q Median 3Q Max ## -31.682 -8.509 -1.014 7.302 120.320 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 72.78932 0.68037 106.985 &lt;2e-16 *** ## H4TO5 0.06870 0.03271 2.101 0.0358 * ## H4TO6 0.08292 0.04769 1.739 0.0822 . ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 12.55 on 1760 degrees of freedom ## (4741 observations deleted due to missingness) ## Multiple R-squared: 0.00942, Adjusted R-squared: 0.008294 ## F-statistic: 8.368 on 2 and 1760 DF, p-value: 0.0002415 Thus, the number of days smoked confounds the relationship between the number of cigarettes smoked per day, and the person’s pulse rate. "],["model-diagnostics-1.html", "9.6 Model Diagnostics", " 9.6 Model Diagnostics The same set of regression diagnostics can be examined to identify any potential influential points, outliers or other problems with the linear model. check_model(mlr.dad.model) "],["what-to-watch-out-for.html", "9.7 What to watch out for", " 9.7 What to watch out for Representative sample Range of prediction should match observed range of X in sample Use of nominal or ordinal, rather than interval or ratio data Errors-in-variables Correlation does not imply causation Violation of assumptions Influential points Appropriate model Multicollinearity "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]

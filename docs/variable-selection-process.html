<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10.4 Variable Selection Process | Applied Statistics</title>
  <meta name="description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="10.4 Variable Selection Process | Applied Statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/AppliedStatistics_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10.4 Variable Selection Process | Applied Statistics" />
  
  <meta name="twitter:description" content="Course notes for Applied Statistics courses at CSU Chico" />
  

<meta name="author" content="Robin Donatello, Edward Roualdes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multicollinearity.html"/>
<link rel="next" href="model-fit-criteria.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Preparing Data for Analysis</b></span></li>
<li class="chapter" data-level="1" data-path="data_prep.html"><a href="data_prep.html"><i class="fa fa-check"></i><b>1</b> Workflow and Data Cleaning</a>
<ul>
<li class="chapter" data-level="1.1" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html"><i class="fa fa-check"></i><b>1.1</b> Generating a reproducible workflows</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html#literate-programming"><i class="fa fa-check"></i><b>1.1.1</b> Literate programming</a></li>
<li class="chapter" data-level="1.1.2" data-path="generating-a-reproducible-workflows.html"><a href="generating-a-reproducible-workflows.html#reproducible-research-literate-programming"><i class="fa fa-check"></i><b>1.1.2</b> Reproducible Research + Literate Programming</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="import-data.html"><a href="import-data.html"><i class="fa fa-check"></i><b>1.2</b> Import data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="import-data.html"><a href="import-data.html#renaming-variable-names-for-sanity-sake"><i class="fa fa-check"></i><b>1.2.1</b> Renaming variable names for sanity sake</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="data-management.html"><a href="data-management.html"><i class="fa fa-check"></i><b>1.3</b> Data Management</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="data-management.html"><a href="data-management.html#missing-data"><i class="fa fa-check"></i><b>1.3.1</b> Missing data</a></li>
<li class="chapter" data-level="1.3.2" data-path="data-management.html"><a href="data-management.html#identifying-variable-types"><i class="fa fa-check"></i><b>1.3.2</b> Identifying Variable Types</a></li>
<li class="chapter" data-level="1.3.3" data-path="data-management.html"><a href="data-management.html#outliers"><i class="fa fa-check"></i><b>1.3.3</b> Outliers</a></li>
<li class="chapter" data-level="1.3.4" data-path="data-management.html"><a href="data-management.html#creating-secondary-variables"><i class="fa fa-check"></i><b>1.3.4</b> Creating secondary variables</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="saving-your-changes.html"><a href="saving-your-changes.html"><i class="fa fa-check"></i><b>1.4</b> Saving your changes</a></li>
<li class="chapter" data-level="1.5" data-path="wide-long.html"><a href="wide-long.html"><i class="fa fa-check"></i><b>1.5</b> Wide vs.Â Long data</a></li>
<li class="chapter" data-level="1.6" data-path="dealing-with-missing-data-post-analysis.html"><a href="dealing-with-missing-data-post-analysis.html"><i class="fa fa-check"></i><b>1.6</b> Dealing with missing data post-analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data_viz.html"><a href="data_viz.html"><i class="fa fa-check"></i><b>2</b> Visualizing Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html"><i class="fa fa-check"></i><b>2.1</b> The syntax of <code>ggplot</code></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#required-arguments"><i class="fa fa-check"></i><b>2.1.1</b> Required arguments</a></li>
<li class="chapter" data-level="2.1.2" data-path="the-syntax-of-ggplot.html"><a href="the-syntax-of-ggplot.html#optional-but-helpful-arguments"><i class="fa fa-check"></i><b>2.1.2</b> Optional but helpful arguments</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>2.2</b> The Data</a></li>
<li class="chapter" data-level="2.3" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html"><i class="fa fa-check"></i><b>2.3</b> Univariate Visualizations</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html#categorical-variables"><i class="fa fa-check"></i><b>2.3.1</b> Categorical variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="univariate-visualizations.html"><a href="univariate-visualizations.html#continuous-measures"><i class="fa fa-check"></i><b>2.3.2</b> Continuous Measures</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html"><i class="fa fa-check"></i><b>2.4</b> Bivariate Visualizations</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#categorical-v.-categorical"><i class="fa fa-check"></i><b>2.4.1</b> Categorical v. Categorical</a></li>
<li class="chapter" data-level="2.4.2" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#grouped-bar-charts-with-percentages"><i class="fa fa-check"></i><b>2.4.2</b> Grouped bar charts with percentages</a></li>
<li class="chapter" data-level="2.4.3" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#continuous-v.-continuous"><i class="fa fa-check"></i><b>2.4.3</b> Continuous v. Continuous</a></li>
<li class="chapter" data-level="2.4.4" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#continuous-v.-categorical"><i class="fa fa-check"></i><b>2.4.4</b> Continuous v. Categorical</a></li>
<li class="chapter" data-level="2.4.5" data-path="bivariate-visualizations.html"><a href="bivariate-visualizations.html#joy-plots-ridgelines"><i class="fa fa-check"></i><b>2.4.5</b> Joy plots / Ridgelines</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="faceting-paneling.html"><a href="faceting-paneling.html"><i class="fa fa-check"></i><b>2.5</b> Faceting / paneling</a></li>
<li class="chapter" data-level="2.6" data-path="multiple-plots-per-window.html"><a href="multiple-plots-per-window.html"><i class="fa fa-check"></i><b>2.6</b> Multiple plots per window</a></li>
<li class="chapter" data-level="2.7" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html"><i class="fa fa-check"></i><b>2.7</b> Multivariate (3+ variables)</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#three-continuous"><i class="fa fa-check"></i><b>2.7.1</b> Three continuous</a></li>
<li class="chapter" data-level="2.7.2" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#scatterplot-matrix"><i class="fa fa-check"></i><b>2.7.2</b> Scatterplot matrix</a></li>
<li class="chapter" data-level="2.7.3" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#two-categorical-and-one-continuous"><i class="fa fa-check"></i><b>2.7.3</b> Two categorical and one continuous</a></li>
<li class="chapter" data-level="2.7.4" data-path="multivariate-3-variables.html"><a href="multivariate-3-variables.html#two-continuous-and-one-categorical"><i class="fa fa-check"></i><b>2.7.4</b> Two continuous and one categorical</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="paneling-on-two-variables.html"><a href="paneling-on-two-variables.html"><i class="fa fa-check"></i><b>2.8</b> Paneling on two variables</a></li>
<li class="chapter" data-level="2.9" data-path="troubleshooting.html"><a href="troubleshooting.html"><i class="fa fa-check"></i><b>2.9</b> Troubleshooting</a></li>
<li class="chapter" data-level="2.10" data-path="but-what-about.html"><a href="but-what-about.html"><i class="fa fa-check"></i><b>2.10</b> But what aboutâ¦</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="but-what-about.html"><a href="but-what-about.html#other-plots-not-mentioned"><i class="fa fa-check"></i><b>2.10.1</b> Other plots not mentioned</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>2.11</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="select_analysis.html"><a href="select_analysis.html"><i class="fa fa-check"></i><b>3</b> Selecting Appropriate Analyses</a></li>
<li class="part"><span><b>II Statistical Inference</b></span></li>
<li class="chapter" data-level="4" data-path="bv-intro.html"><a href="bv-intro.html"><i class="fa fa-check"></i><b>4</b> Foundations for Inference</a></li>
<li class="chapter" data-level="5" data-path="bivariate-analysis.html"><a href="bivariate-analysis.html"><i class="fa fa-check"></i><b>5</b> Bivariate Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="assumption-of-independent-observations.html"><a href="assumption-of-independent-observations.html"><i class="fa fa-check"></i><b>5.1</b> Assumption of Independent Observations</a></li>
<li class="chapter" data-level="5.2" data-path="choosing-appropriate-bivariate-analysis.html"><a href="choosing-appropriate-bivariate-analysis.html"><i class="fa fa-check"></i><b>5.2</b> Choosing appropriate bivariate analysis</a></li>
<li class="chapter" data-level="5.3" data-path="bv-ttest.html"><a href="bv-ttest.html"><i class="fa fa-check"></i><b>5.3</b> (Q~B) Two means: T-Test</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bv-ttest.html"><a href="bv-ttest.html#assumptions"><i class="fa fa-check"></i><b>5.3.1</b> Assumptions</a></li>
<li class="chapter" data-level="5.3.2" data-path="bv-ttest.html"><a href="bv-ttest.html#sampling-distribution-for-the-difference"><i class="fa fa-check"></i><b>5.3.2</b> Sampling Distribution for the difference</a></li>
<li class="chapter" data-level="5.3.3" data-path="bv-ttest.html"><a href="bv-ttest.html#example-smoking-and-bmi"><i class="fa fa-check"></i><b>5.3.3</b> Example: Smoking and BMI</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bv-anova.html"><a href="bv-anova.html"><i class="fa fa-check"></i><b>5.4</b> (Q~C) Multiple means: ANOVA</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="bv-anova.html"><a href="bv-anova.html#formulation-of-the-one-way-anova-model"><i class="fa fa-check"></i><b>5.4.1</b> Formulation of the One-way ANOVA model</a></li>
<li class="chapter" data-level="5.4.2" data-path="bv-anova.html"><a href="bv-anova.html#analysis-of-variance-table"><i class="fa fa-check"></i><b>5.4.2</b> Analysis of Variance Table*:</a></li>
<li class="chapter" data-level="5.4.3" data-path="bv-anova.html"><a href="bv-anova.html#the-f-distribution"><i class="fa fa-check"></i><b>5.4.3</b> The F-distribution</a></li>
<li class="chapter" data-level="5.4.4" data-path="bv-anova.html"><a href="bv-anova.html#assumptions-1"><i class="fa fa-check"></i><b>5.4.4</b> Assumptions</a></li>
<li class="chapter" data-level="5.4.5" data-path="bv-anova.html"><a href="bv-anova.html#example-a-comparison-of-plant-species-under-low-water-conditions"><i class="fa fa-check"></i><b>5.4.5</b> Example: A comparison of plant species under low water conditions</a></li>
<li class="chapter" data-level="5.4.6" data-path="bv-anova.html"><a href="bv-anova.html#coefficient-of-determination-r2"><i class="fa fa-check"></i><b>5.4.6</b> Coefficient of determination <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="5.4.7" data-path="bv-anova.html"><a href="bv-anova.html#multiple-comparisons"><i class="fa fa-check"></i><b>5.4.7</b> Multiple Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="bv-chisq.html"><a href="bv-chisq.html"><i class="fa fa-check"></i><b>5.5</b> (C~C) Multiple Proportions: <span class="math inline">\(\chi^{2}\)</span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="bv-chisq.html"><a href="bv-chisq.html#conditions-for-the-sampling-distribution-to-be-normal."><i class="fa fa-check"></i><b>5.5.1</b> Conditions for the sampling distribution to be normal.</a></li>
<li class="chapter" data-level="5.5.2" data-path="bv-chisq.html"><a href="bv-chisq.html#example-are-mammograms-effective"><i class="fa fa-check"></i><b>5.5.2</b> Example: Are Mammograms effective?</a></li>
<li class="chapter" data-level="5.5.3" data-path="bv-chisq.html"><a href="bv-chisq.html#example-smoking-and-general-health"><i class="fa fa-check"></i><b>5.5.3</b> Example: Smoking and General Health</a></li>
<li class="chapter" data-level="5.5.4" data-path="bv-chisq.html"><a href="bv-chisq.html#multiple-comparisons-1"><i class="fa fa-check"></i><b>5.5.4</b> Multiple Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="bv-corr.html"><a href="bv-corr.html"><i class="fa fa-check"></i><b>5.6</b> (Q~Q) Correlation</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="bv-corr.html"><a href="bv-corr.html#strength-of-the-correlation"><i class="fa fa-check"></i><b>5.6.1</b> Strength of the correlation</a></li>
<li class="chapter" data-level="5.6.2" data-path="bv-corr.html"><a href="bv-corr.html#example-federal-spending-per-capita-and-poverty-rate"><i class="fa fa-check"></i><b>5.6.2</b> Example: Federal spending per capita and poverty rate</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Regression Modeling</b></span></li>
<li class="chapter" data-level="6" data-path="reg-intro.html"><a href="reg-intro.html"><i class="fa fa-check"></i><b>6</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="opening-remarks.html"><a href="opening-remarks.html"><i class="fa fa-check"></i><b>6.1</b> Opening Remarks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="slr.html"><a href="slr.html"><i class="fa fa-check"></i><b>7</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>7.1</b> Example</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="example.html"><a href="example.html#caution-on-out-of-range-predictions"><i class="fa fa-check"></i><b>7.1.1</b> Caution on out of range predictions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="mathematical-model.html"><a href="mathematical-model.html"><i class="fa fa-check"></i><b>7.2</b> Mathematical Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="mathematical-model.html"><a href="mathematical-model.html#unifying-model-framework"><i class="fa fa-check"></i><b>7.2.1</b> Unifying model framework</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="parameter-estimates.html"><a href="parameter-estimates.html"><i class="fa fa-check"></i><b>7.3</b> Parameter Estimates</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="parameter-estimates.html"><a href="parameter-estimates.html#sum-of-squares"><i class="fa fa-check"></i><b>7.3.1</b> Sum of Squares</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="assumptions-2.html"><a href="assumptions-2.html"><i class="fa fa-check"></i><b>7.4</b> Assumptions</a></li>
<li class="chapter" data-level="7.5" data-path="slr-fev.html"><a href="slr-fev.html"><i class="fa fa-check"></i><b>7.5</b> Example</a></li>
<li class="chapter" data-level="7.6" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>7.6</b> Model Diagnostics</a></li>
<li class="chapter" data-level="7.7" data-path="prediction.html"><a href="prediction.html"><i class="fa fa-check"></i><b>7.7</b> Prediction</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="prediction.html"><a href="prediction.html#predict-the-average-value-of-y-haty-based-on-the-model"><i class="fa fa-check"></i><b>7.7.1</b> Predict the <em>average</em> value of Y (<span class="math inline">\(\hat{y}\)</span>) based on the model</a></li>
<li class="chapter" data-level="7.7.2" data-path="prediction.html"><a href="prediction.html#confidence-intervals-for-the-predicted-mean"><i class="fa fa-check"></i><b>7.7.2</b> Confidence intervals for the predicted mean</a></li>
<li class="chapter" data-level="7.7.3" data-path="prediction.html"><a href="prediction.html#predict-the-average-value-of-y-haty_i-for-a-certain-value-of-x"><i class="fa fa-check"></i><b>7.7.3</b> Predict the <em>average</em> value of Y <span class="math inline">\((\hat{y_{i}})\)</span> for a certain value of <span class="math inline">\(x^{*}\)</span></a></li>
<li class="chapter" data-level="7.7.4" data-path="prediction.html"><a href="prediction.html#predict-a-new-value-of-y-haty_i-for-a-certain-value-of-x"><i class="fa fa-check"></i><b>7.7.4</b> Predict a <em>new</em> value of Y <span class="math inline">\(\hat{y_{i}}\)</span> for a certain value of <span class="math inline">\(x^{*}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="anova-for-regression.html"><a href="anova-for-regression.html"><i class="fa fa-check"></i><b>7.8</b> ANOVA for regression</a></li>
<li class="chapter" data-level="7.9" data-path="correlation-coefficient.html"><a href="correlation-coefficient.html"><i class="fa fa-check"></i><b>7.9</b> Correlation Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mod-strat.html"><a href="mod-strat.html"><i class="fa fa-check"></i><b>8</b> Moderation and Stratification</a>
<ul>
<li class="chapter" data-level="8.1" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>8.1</b> Moderation</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="moderation.html"><a href="moderation.html#example-1-simpsons-paradox"><i class="fa fa-check"></i><b>8.1.1</b> Example 1: Simpsonâs Paradox</a></li>
<li class="chapter" data-level="8.1.2" data-path="moderation.html"><a href="moderation.html#example-2-sepal-vs-petal-length-in-iris-flowers"><i class="fa fa-check"></i><b>8.1.2</b> Example 2: Sepal vs Petal Length in Iris flowers</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>8.2</b> Stratification</a></li>
<li class="chapter" data-level="8.3" data-path="identifying-a-moderator.html"><a href="identifying-a-moderator.html"><i class="fa fa-check"></i><b>8.3</b> Identifying a moderator</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="identifying-a-moderator.html"><a href="identifying-a-moderator.html#what-to-look-for-in-each-type-of-analysis"><i class="fa fa-check"></i><b>8.3.1</b> What to look for in each type of analysis</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="example-2-cont.-correlation-regression.html"><a href="example-2-cont.-correlation-regression.html"><i class="fa fa-check"></i><b>8.4</b> Example 2 (cont.) Correlation &amp; Regression</a></li>
<li class="chapter" data-level="8.5" data-path="example-3-anova.html"><a href="example-3-anova.html"><i class="fa fa-check"></i><b>8.5</b> Example 3: ANOVA</a></li>
<li class="chapter" data-level="8.6" data-path="example-4-chi-squared.html"><a href="example-4-chi-squared.html"><i class="fa fa-check"></i><b>8.6</b> Example 4: Chi-Squared</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mlr.html"><a href="mlr.html"><i class="fa fa-check"></i><b>9</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mathematical-model-1.html"><a href="mathematical-model-1.html"><i class="fa fa-check"></i><b>9.1</b> Mathematical Model</a></li>
<li class="chapter" data-level="9.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>9.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="9.3" data-path="fitting-the-model.html"><a href="fitting-the-model.html"><i class="fa fa-check"></i><b>9.3</b> Fitting the model</a></li>
<li class="chapter" data-level="9.4" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html"><i class="fa fa-check"></i><b>9.4</b> Interpreting Coefficients</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#continuous-predictors"><i class="fa fa-check"></i><b>9.4.1</b> Continuous predictors</a></li>
<li class="chapter" data-level="9.4.2" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#binary-predictors"><i class="fa fa-check"></i><b>9.4.2</b> Binary predictors</a></li>
<li class="chapter" data-level="9.4.3" data-path="interpreting-coefficients.html"><a href="interpreting-coefficients.html#cat-predictors"><i class="fa fa-check"></i><b>9.4.3</b> Categorical Predictors</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="presenting-results.html"><a href="presenting-results.html"><i class="fa fa-check"></i><b>9.5</b> Presenting results</a></li>
<li class="chapter" data-level="9.6" data-path="confounding.html"><a href="confounding.html"><i class="fa fa-check"></i><b>9.6</b> Confounding</a></li>
<li class="chapter" data-level="9.7" data-path="what-to-watch-out-for.html"><a href="what-to-watch-out-for.html"><i class="fa fa-check"></i><b>9.7</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>10</b> Model Building</a>
<ul>
<li class="chapter" data-level="10.1" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>10.1</b> Interactions</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="interactions.html"><a href="interactions.html#fitting-interaction-models-interpreting-coefficients"><i class="fa fa-check"></i><b>10.1.1</b> Fitting interaction models &amp; interpreting coefficients</a></li>
<li class="chapter" data-level="10.1.2" data-path="interactions.html"><a href="interactions.html#interactions-catvars"><i class="fa fa-check"></i><b>10.1.2</b> Categorical Interaction variables</a></li>
<li class="chapter" data-level="10.1.3" data-path="interactions.html"><a href="interactions.html#example-2"><i class="fa fa-check"></i><b>10.1.3</b> Example 2</a></li>
<li class="chapter" data-level="10.1.4" data-path="interactions.html"><a href="interactions.html#example-3"><i class="fa fa-check"></i><b>10.1.4</b> Example 3:</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="wald-test.html"><a href="wald-test.html"><i class="fa fa-check"></i><b>10.2</b> Wald test</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="wald-test.html"><a href="wald-test.html#example-modeling-depression-score"><i class="fa fa-check"></i><b>10.2.1</b> Example: Modeling depression score</a></li>
<li class="chapter" data-level="10.2.2" data-path="wald-test.html"><a href="wald-test.html#testing-for-a-moderation-effect-in-a-multiple-regression-model."><i class="fa fa-check"></i><b>10.2.2</b> Testing for a moderation effect in a multiple regression model.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i><b>10.3</b> Multicollinearity</a></li>
<li class="chapter" data-level="10.4" data-path="variable-selection-process.html"><a href="variable-selection-process.html"><i class="fa fa-check"></i><b>10.4</b> Variable Selection Process</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="variable-selection-process.html"><a href="variable-selection-process.html#automated-selection-procedures"><i class="fa fa-check"></i><b>10.4.1</b> Automated selection procedures</a></li>
<li class="chapter" data-level="10.4.2" data-path="variable-selection-process.html"><a href="variable-selection-process.html#implementation-of-stepwise-selection-in-r"><i class="fa fa-check"></i><b>10.4.2</b> Implementation of stepwise selection in R</a></li>
<li class="chapter" data-level="10.4.3" data-path="variable-selection-process.html"><a href="variable-selection-process.html#lasso-regression-pma6-9.7"><i class="fa fa-check"></i><b>10.4.3</b> LASSO Regression (PMA6 9.7)</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html"><i class="fa fa-check"></i><b>10.5</b> Comparing between models</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#rss-residual-sum-of-squares"><i class="fa fa-check"></i><b>10.5.1</b> RSS: Residual Sum of Squares</a></li>
<li class="chapter" data-level="10.5.2" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#general-F"><i class="fa fa-check"></i><b>10.5.2</b> General F Test</a></li>
<li class="chapter" data-level="10.5.3" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#likelihood-function"><i class="fa fa-check"></i><b>10.5.3</b> Likelihood function</a></li>
<li class="chapter" data-level="10.5.4" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#multiple-r2"><i class="fa fa-check"></i><b>10.5.4</b> Multiple <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="10.5.5" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#adjusted-r2"><i class="fa fa-check"></i><b>10.5.5</b> Adjusted <span class="math inline">\(R^{2}\)</span></a></li>
<li class="chapter" data-level="10.5.6" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#mallows-c_p"><i class="fa fa-check"></i><b>10.5.6</b> Mallows <span class="math inline">\(C_{p}\)</span></a></li>
<li class="chapter" data-level="10.5.7" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#akaike-information-criterion-aic"><i class="fa fa-check"></i><b>10.5.7</b> Akaike Information Criterion (AIC)</a></li>
<li class="chapter" data-level="10.5.8" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#bayesian-information-criterion-bic"><i class="fa fa-check"></i><b>10.5.8</b> Bayesian Information Criterion (BIC)</a></li>
<li class="chapter" data-level="10.5.9" data-path="model-fit-criteria.html"><a href="model-fit-criteria.html#aic-vs-bic"><i class="fa fa-check"></i><b>10.5.9</b> AIC vs BIC</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html"><i class="fa fa-check"></i><b>10.6</b> Model Diagnostics</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#linearity"><i class="fa fa-check"></i><b>10.6.1</b> Linearity</a></li>
<li class="chapter" data-level="10.6.2" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#normality-of-residuals."><i class="fa fa-check"></i><b>10.6.2</b> Normality of residuals.</a></li>
<li class="chapter" data-level="10.6.3" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#homogeneity-of-variance"><i class="fa fa-check"></i><b>10.6.3</b> Homogeneity of variance</a></li>
<li class="chapter" data-level="10.6.4" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#posterior-predictions"><i class="fa fa-check"></i><b>10.6.4</b> Posterior Predictions</a></li>
<li class="chapter" data-level="10.6.5" data-path="model-diagnostics-1.html"><a href="model-diagnostics-1.html#all-at-once"><i class="fa fa-check"></i><b>10.6.5</b> All at once</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="general-advice-pma6-9.html"><a href="general-advice-pma6-9.html"><i class="fa fa-check"></i><b>10.7</b> General Advice (PMA6 9.9)</a></li>
<li class="chapter" data-level="10.8" data-path="what-to-watch-out-for-pma6-9.html"><a href="what-to-watch-out-for-pma6-9.html"><i class="fa fa-check"></i><b>10.8</b> What to watch out for (PMA6 9.10)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>11</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="fitting-glms.html"><a href="fitting-glms.html"><i class="fa fa-check"></i><b>11.1</b> Fitting GLMs</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="fitting-glms.html"><a href="fitting-glms.html#r"><i class="fa fa-check"></i><b>11.1.1</b> R</a></li>
<li class="chapter" data-level="11.1.2" data-path="fitting-glms.html"><a href="fitting-glms.html#spss"><i class="fa fa-check"></i><b>11.1.2</b> SPSS</a></li>
<li class="chapter" data-level="11.1.3" data-path="fitting-glms.html"><a href="fitting-glms.html#stata"><i class="fa fa-check"></i><b>11.1.3</b> Stata</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="binary-outcome-data.html"><a href="binary-outcome-data.html"><i class="fa fa-check"></i><b>11.2</b> Binary outcome data</a></li>
<li class="chapter" data-level="11.3" data-path="logreg.html"><a href="logreg.html"><i class="fa fa-check"></i><b>11.3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="logreg.html"><a href="logreg.html#interpreting-odds-ratios"><i class="fa fa-check"></i><b>11.3.1</b> Interpreting Odds Ratios</a></li>
<li class="chapter" data-level="11.3.2" data-path="logreg.html"><a href="logreg.html#or-ci"><i class="fa fa-check"></i><b>11.3.2</b> Confidence Intervals</a></li>
<li class="chapter" data-level="11.3.3" data-path="logreg.html"><a href="logreg.html#logreg-dep-ex"><i class="fa fa-check"></i><b>11.3.3</b> Example: The effect of gender on Depression</a></li>
<li class="chapter" data-level="11.3.4" data-path="logreg.html"><a href="logreg.html#mlogreg"><i class="fa fa-check"></i><b>11.3.4</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="11.3.5" data-path="logreg.html"><a href="logreg.html#effect-of-a-k-unit-change"><i class="fa fa-check"></i><b>11.3.5</b> Effect of a k unit change</a></li>
<li class="chapter" data-level="11.3.6" data-path="logreg.html"><a href="logreg.html#example-predictors-of-smoking-status"><i class="fa fa-check"></i><b>11.3.6</b> Example: Predictors of smoking status</a></li>
<li class="chapter" data-level="11.3.7" data-path="logreg.html"><a href="logreg.html#model-fit"><i class="fa fa-check"></i><b>11.3.7</b> Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="log-linear.html"><a href="log-linear.html"><i class="fa fa-check"></i><b>11.4</b> Log-linear models</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="log-linear.html"><a href="log-linear.html#example-4"><i class="fa fa-check"></i><b>11.4.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="poisson-reg.html"><a href="poisson-reg.html"><i class="fa fa-check"></i><b>11.5</b> Count outcome data</a></li>
<li class="chapter" data-level="11.6" data-path="multinomial-reg.html"><a href="multinomial-reg.html"><i class="fa fa-check"></i><b>11.6</b> Categorical outcome data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="binary-classification.html"><a href="binary-classification.html"><i class="fa fa-check"></i><b>12</b> Classification of Binary outcomes</a>
<ul>
<li class="chapter" data-level="12.1" data-path="predicted-probabilities.html"><a href="predicted-probabilities.html"><i class="fa fa-check"></i><b>12.1</b> Predicted Probabilities</a></li>
<li class="chapter" data-level="12.2" data-path="predicted-class-outcome.html"><a href="predicted-class-outcome.html"><i class="fa fa-check"></i><b>12.2</b> Predicted Class (outcome)</a></li>
<li class="chapter" data-level="12.3" data-path="confusion-matrix.html"><a href="confusion-matrix.html"><i class="fa fa-check"></i><b>12.3</b> Confusion Matrix</a></li>
<li class="chapter" data-level="12.4" data-path="vocabulary-terms.html"><a href="vocabulary-terms.html"><i class="fa fa-check"></i><b>12.4</b> Vocabulary terms</a></li>
<li class="chapter" data-level="12.5" data-path="roc-curves.html"><a href="roc-curves.html"><i class="fa fa-check"></i><b>12.5</b> ROC Curves</a></li>
<li class="chapter" data-level="12.6" data-path="model-performance.html"><a href="model-performance.html"><i class="fa fa-check"></i><b>12.6</b> Model Performance</a></li>
</ul></li>
<li class="part"><span><b>IV Multivariate Analysis</b></span></li>
<li class="chapter" data-level="13" data-path="mv-intro.html"><a href="mv-intro.html"><i class="fa fa-check"></i><b>13</b> Introduction</a></li>
<li class="chapter" data-level="14" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>14</b> Factor Analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>14.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="introduction.html"><a href="introduction.html#latent-constructs"><i class="fa fa-check"></i><b>14.1.1</b> Latent Constructs</a></li>
<li class="chapter" data-level="14.1.2" data-path="introduction.html"><a href="introduction.html#comparison-with-pca"><i class="fa fa-check"></i><b>14.1.2</b> Comparison with PCA</a></li>
<li class="chapter" data-level="14.1.3" data-path="introduction.html"><a href="introduction.html#efa-vs-cfa"><i class="fa fa-check"></i><b>14.1.3</b> EFA vs CFA</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="factor-model.html"><a href="factor-model.html"><i class="fa fa-check"></i><b>14.2</b> Factor Model</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="factor-model.html"><a href="factor-model.html#components-of-variance"><i class="fa fa-check"></i><b>14.2.1</b> Components of Variance</a></li>
<li class="chapter" data-level="14.2.2" data-path="factor-model.html"><a href="factor-model.html#two-big-steps"><i class="fa fa-check"></i><b>14.2.2</b> Two big steps</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="fa-example.html"><a href="fa-example.html"><i class="fa fa-check"></i><b>14.3</b> Example data setup</a></li>
<li class="chapter" data-level="14.4" data-path="fa-extract.html"><a href="fa-extract.html"><i class="fa fa-check"></i><b>14.4</b> Factor Extraction Methods</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="fa-extract.html"><a href="fa-extract.html#principal-components-pc-factor-model"><i class="fa fa-check"></i><b>14.4.1</b> Principal components (PC Factor model)</a></li>
<li class="chapter" data-level="14.4.2" data-path="fa-extract.html"><a href="fa-extract.html#iterated-components"><i class="fa fa-check"></i><b>14.4.2</b> Iterated components</a></li>
<li class="chapter" data-level="14.4.3" data-path="fa-extract.html"><a href="fa-extract.html#maximum-likelihood"><i class="fa fa-check"></i><b>14.4.3</b> Maximum Likelihood</a></li>
<li class="chapter" data-level="14.4.4" data-path="fa-extract.html"><a href="fa-extract.html#uniqueness"><i class="fa fa-check"></i><b>14.4.4</b> Uniqueness</a></li>
<li class="chapter" data-level="14.4.5" data-path="fa-extract.html"><a href="fa-extract.html#resulting-factors"><i class="fa fa-check"></i><b>14.4.5</b> Resulting factors</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="rotating-factors.html"><a href="rotating-factors.html"><i class="fa fa-check"></i><b>14.5</b> Rotating Factors</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="rotating-factors.html"><a href="rotating-factors.html#varimax-rotation"><i class="fa fa-check"></i><b>14.5.1</b> Varimax Rotation</a></li>
<li class="chapter" data-level="14.5.2" data-path="rotating-factors.html"><a href="rotating-factors.html#oblique-rotation"><i class="fa fa-check"></i><b>14.5.2</b> Oblique rotation</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="factor-scores.html"><a href="factor-scores.html"><i class="fa fa-check"></i><b>14.6</b> Factor Scores</a></li>
<li class="chapter" data-level="14.7" data-path="what-to-watch-out-for-1.html"><a href="what-to-watch-out-for-1.html"><i class="fa fa-check"></i><b>14.7</b> What to watch out for</a></li>
<li class="chapter" data-level="14.8" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>14.8</b> Additional Resources</a></li>
</ul></li>
<li class="part"><span><b>V Multi-level Modeling</b></span></li>
<li class="chapter" data-level="15" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>15</b> Introduction</a>
<ul>
<li class="chapter" data-level="15.1" data-path="example-school-data.html"><a href="example-school-data.html"><i class="fa fa-check"></i><b>15.1</b> Example School Data</a></li>
<li class="chapter" data-level="15.2" data-path="multi-level-models.html"><a href="multi-level-models.html"><i class="fa fa-check"></i><b>15.2</b> Multi-level models</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="RI.html"><a href="RI.html"><i class="fa fa-check"></i><b>16</b> Random Intercept Models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="pooling.html"><a href="pooling.html"><i class="fa fa-check"></i><b>16.1</b> Pooling</a></li>
<li class="chapter" data-level="16.2" data-path="mathri.html"><a href="mathri.html"><i class="fa fa-check"></i><b>16.2</b> Mathematical Models</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="mathri.html"><a href="mathri.html#complete-pooling"><i class="fa fa-check"></i><b>16.2.1</b> Complete Pooling</a></li>
<li class="chapter" data-level="16.2.2" data-path="mathri.html"><a href="mathri.html#no-pooling"><i class="fa fa-check"></i><b>16.2.2</b> No Pooling</a></li>
<li class="chapter" data-level="16.2.3" data-path="mathri.html"><a href="mathri.html#partial-pooling-ri"><i class="fa fa-check"></i><b>16.2.3</b> Partial Pooling (RI)</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="components-of-variance-1.html"><a href="components-of-variance-1.html"><i class="fa fa-check"></i><b>16.3</b> Components of Variance</a></li>
<li class="chapter" data-level="16.4" data-path="fitri.html"><a href="fitri.html"><i class="fa fa-check"></i><b>16.4</b> Fitting models in R</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="fitri.html"><a href="fitri.html#comparison-of-estimates"><i class="fa fa-check"></i><b>16.4.1</b> Comparison of estimates</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="estimation-methods.html"><a href="estimation-methods.html"><i class="fa fa-check"></i><b>16.5</b> Estimation Methods</a></li>
<li class="chapter" data-level="16.6" data-path="including-covariates.html"><a href="including-covariates.html"><i class="fa fa-check"></i><b>16.6</b> Including Covariates</a></li>
<li class="chapter" data-level="16.7" data-path="more-random-effects.html"><a href="more-random-effects.html"><i class="fa fa-check"></i><b>16.7</b> More Random Effects</a></li>
<li class="chapter" data-level="16.8" data-path="centering-terms.html"><a href="centering-terms.html"><i class="fa fa-check"></i><b>16.8</b> Centering terms</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="centering-terms.html"><a href="centering-terms.html#a-generic-dplyr-approach-to-centering."><i class="fa fa-check"></i><b>16.8.1</b> A generic <code>dplyr</code> approach to centering.</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="specifying-correlation-structures.html"><a href="specifying-correlation-structures.html"><i class="fa fa-check"></i><b>16.9</b> Specifying Correlation Structures</a>
<ul>
<li class="chapter" data-level="16.9.1" data-path="specifying-correlation-structures.html"><a href="specifying-correlation-structures.html#changing-covariance-structures-in-r"><i class="fa fa-check"></i><b>16.9.1</b> Changing covariance structures in R</a></li>
</ul></li>
<li class="chapter" data-level="16.10" data-path="additional-references.html"><a href="additional-references.html"><i class="fa fa-check"></i><b>16.10</b> Additional References</a>
<ul>
<li class="chapter" data-level="16.10.1" data-path="additional-references.html"><a href="additional-references.html#lecture-notes-from-other-classes-found-on-the-interwebs"><i class="fa fa-check"></i><b>16.10.1</b> Lecture notes from other classes found on the interwebs</a></li>
<li class="chapter" data-level="16.10.2" data-path="additional-references.html"><a href="additional-references.html#package-vignettes"><i class="fa fa-check"></i><b>16.10.2</b> Package Vignettes</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Other Topics</b></span></li>
<li class="chapter" data-level="17" data-path="mda.html"><a href="mda.html"><i class="fa fa-check"></i><b>17</b> Missing Data</a>
<ul>
<li class="chapter" data-level="17.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html"><i class="fa fa-check"></i><b>17.1</b> Identifying missing data</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="identifying-missing-data.html"><a href="identifying-missing-data.html#visualize-missing-patterns"><i class="fa fa-check"></i><b>17.1.1</b> Visualize missing patterns</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="effects-of-nonresponse.html"><a href="effects-of-nonresponse.html"><i class="fa fa-check"></i><b>17.2</b> Effects of Nonresponse</a></li>
<li class="chapter" data-level="17.3" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html"><i class="fa fa-check"></i><b>17.3</b> Missing Data Mechanisms</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="missing-data-mechanisms.html"><a href="missing-data-mechanisms.html#demonstration-via-simulation"><i class="fa fa-check"></i><b>17.3.1</b> Demonstration via Simulation</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="general-strategies.html"><a href="general-strategies.html"><i class="fa fa-check"></i><b>17.4</b> General strategies</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="general-strategies.html"><a href="general-strategies.html#complete-cases-analysis"><i class="fa fa-check"></i><b>17.4.1</b> Complete cases analysis</a></li>
<li class="chapter" data-level="17.4.2" data-path="general-strategies.html"><a href="general-strategies.html#available-case-analysis"><i class="fa fa-check"></i><b>17.4.2</b> Available-case analysis</a></li>
<li class="chapter" data-level="17.4.3" data-path="general-strategies.html"><a href="general-strategies.html#imputation"><i class="fa fa-check"></i><b>17.4.3</b> Imputation</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="imputation-methods.html"><a href="imputation-methods.html"><i class="fa fa-check"></i><b>17.5</b> Imputation Methods</a></li>
<li class="chapter" data-level="17.6" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html"><i class="fa fa-check"></i><b>17.6</b> Multiple Imputation (MI)</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#goals"><i class="fa fa-check"></i><b>17.6.1</b> Goals</a></li>
<li class="chapter" data-level="17.6.2" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#technique"><i class="fa fa-check"></i><b>17.6.2</b> Technique</a></li>
<li class="chapter" data-level="17.6.3" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#mi-as-a-paradigm"><i class="fa fa-check"></i><b>17.6.3</b> MI as a paradigm</a></li>
<li class="chapter" data-level="17.6.4" data-path="multiple-imputation-mi.html"><a href="multiple-imputation-mi.html#inference-on-mi"><i class="fa fa-check"></i><b>17.6.4</b> Inference on MI</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html"><i class="fa fa-check"></i><b>17.7</b> Multiple Imputation using Chained Equations (MICE)</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#overview"><i class="fa fa-check"></i><b>17.7.1</b> Overview</a></li>
<li class="chapter" data-level="17.7.2" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#process-algorithm"><i class="fa fa-check"></i><b>17.7.2</b> Process / Algorithm</a></li>
<li class="chapter" data-level="17.7.3" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#convergence"><i class="fa fa-check"></i><b>17.7.3</b> Convergence</a></li>
<li class="chapter" data-level="17.7.4" data-path="multiple-imputation-using-chained-equations-mice.html"><a href="multiple-imputation-using-chained-equations-mice.html#imputation-methods-1"><i class="fa fa-check"></i><b>17.7.4</b> Imputation Methods</a></li>
</ul></li>
<li class="chapter" data-level="17.8" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>17.8</b> Diagnostics</a></li>
<li class="chapter" data-level="17.9" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html"><i class="fa fa-check"></i><b>17.9</b> Example: Prescribed amount of missing.</a>
<ul>
<li class="chapter" data-level="17.9.1" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#multiply-impute-the-missing-data-using-mice"><i class="fa fa-check"></i><b>17.9.1</b> Multiply impute the missing data using <code>mice()</code></a></li>
<li class="chapter" data-level="17.9.2" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#check-the-imputation-method-used-on-each-variable."><i class="fa fa-check"></i><b>17.9.2</b> Check the imputation method used on each variable.</a></li>
<li class="chapter" data-level="17.9.3" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#check-convergence"><i class="fa fa-check"></i><b>17.9.3</b> Check Convergence</a></li>
<li class="chapter" data-level="17.9.4" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#look-at-the-values-generated-for-imputation"><i class="fa fa-check"></i><b>17.9.4</b> Look at the values generated for imputation</a></li>
<li class="chapter" data-level="17.9.5" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#create-a-complete-data-set-by-filling-in-the-missing-data-using-the-imputations"><i class="fa fa-check"></i><b>17.9.5</b> Create a complete data set by filling in the missing data using the imputations</a></li>
<li class="chapter" data-level="17.9.6" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#visualize-imputations"><i class="fa fa-check"></i><b>17.9.6</b> Visualize Imputations</a></li>
<li class="chapter" data-level="17.9.7" data-path="example-prescribed-amount-of-missing..html"><a href="example-prescribed-amount-of-missing..html#calculating-bias"><i class="fa fa-check"></i><b>17.9.7</b> Calculating bias</a></li>
</ul></li>
<li class="chapter" data-level="17.10" data-path="final-thoughts.html"><a href="final-thoughts.html"><i class="fa fa-check"></i><b>17.10</b> Final thoughts</a></li>
<li class="chapter" data-level="17.11" data-path="additional-references-1.html"><a href="additional-references-1.html"><i class="fa fa-check"></i><b>17.11</b> Additional References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/AppliedStatistics_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variable-selection-process" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Variable Selection Process<a href="variable-selection-process.html#variable-selection-process" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Ref: PMA6 CH 9</p>
</blockquote>
<p>Variable selection methods such as the ones described in this section, are most often used when performing an <em>Exploratory</em> analysis, where many independent variables have been measured, but a final model to explain the variability of a dependent variable has not yet been determined.</p>
<p>When building a model, we want to choose a set of independent variables that both will yield a good prediction using as few variables as possible (<em>parsimony</em>). We also need to consider controlling for moderators and confounders. In many situations where regression is used, the investigator has strong justification for including certain variables in the model.</p>
<ul>
<li>previous studies</li>
<li>accepted theory</li>
</ul>
<p>The investigator may have prior justification for using certain variables but may be open to suggestions for the remaining variables.</p>
<p>The set of independent variables can be broken down into logical subsets</p>
<ol style="list-style-type: decimal">
<li><strong>Factors of primary interest</strong>. (such as an exposure or treatment)</li>
<li><strong>Potential confounders</strong>. These are measures that could be associated with both the response, and explanatory variables, and which could <em>explain</em> the relationship between the primary factor of interest and the outcome. These are typically a set of demographics such as age, gender, ethnicity, and tend to be factors found to be important in prior studies.</li>
<li><strong>Effect Modifiers (Moderators)</strong>. A set of variables that other studies have shown to change or affect the relationship between the explanatory and response variables.</li>
<li><strong>Precision variables (covariates)</strong>. Variables associated with the dependent variable, but not the primary factor of interest.</li>
</ol>
<p>How variables are chosen for inclusion into a model is heavily driven by the purpose of the model:</p>
<ul>
<li>descriptive</li>
<li>predictive</li>
</ul>
<div id="automated-selection-procedures" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Automated selection procedures<a href="variable-selection-process.html#automated-selection-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><em>Forward selection</em>: Variables are added one at a time until optimal model reached.</p>
<ol style="list-style-type: decimal">
<li>Choose the variable with the highest absolute correlation <span class="math inline">\(\mid r \mid\)</span> with the outcome.</li>
<li>Choose the next variable that maximizes the model adjusted <span class="math inline">\(R^{2}\)</span>.</li>
<li>Repeat until adding additional variables does not improve the model fit significantly.</li>
</ol>
<p><em>Backward elimination</em>: Variables are removed one at a time until optimal model reached</p>
<ol style="list-style-type: decimal">
<li>Put all variables into the model.</li>
<li>Remove the least useful variable in the model. This can be done by choosing the variable with the largest <span class="math inline">\(p\)</span>-value.</li>
<li>Repeat until removing additional variables reduces the model fit significantly.</li>
</ol>
<p><em>Stepwise selection</em>: Combination of forward and backward.</p>
<ol start="0" style="list-style-type: decimal">
<li>Start with no variables (just <span class="math inline">\(\bar{Y}\)</span>)</li>
<li>Add the variable that results in the greatest improvement in model fit.</li>
<li>Add another variable that results in the greatest improvement in model fit after controlling for the first.</li>
<li>Check to see if removing any variable currently in the model improves the fit.</li>
<li>Add another variableâ¦</li>
<li>Check to remove variablesâ¦</li>
<li>Repeat until no variables can be added or removed.</li>
</ol>
<p>Most programs have the option to <strong>force</strong> variables to be included in the model. This is important in cases where there is a primary factor of interest such as a treatment effect.</p>

<div class="rmdcaution">
Automated versions of variable selection processes should not be used blindly.
</div>
<blockquote>
<p>ââ¦ perhaps the most serious source of error lies in letting statistical procedures make decisions for you.â
âDonât be too quick to turn on the computer. Bypassing the brain to compute by reflex is a sure recipe for disaster.â
<em>Good and Hardin, Common Errors in Statistics (and How to Avoid Them), p.Â 3, p.Â 152</em></p>
</blockquote>
<p>Warnings:</p>
<ul>
<li>Stopping criteria and algorithm can be different for different software programs.</li>
<li>Can reject perfectly plausible models from later consideration</li>
<li>Hides relationships between variables (X3 is added and now X1 is no longer significant. X1 vs X3 should be looked at)</li>
</ul>
<p><em>Best Subsets</em></p>
<ul>
<li>Select one X with highest simple <span class="math inline">\(r\)</span> with Y</li>
<li>Select two Xâs with highest multiple <span class="math inline">\(r\)</span> with Y</li>
<li>Select three Xâs with highest multiple <span class="math inline">\(r\)</span> with Y
etc.</li>
<li>Compute adjusted R2, AIC or BIC each time.</li>
<li>Compare and choose among the âbest subsetsâ of various sizes.</li>
</ul>
</div>
<div id="implementation-of-stepwise-selection-in-r" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Implementation of stepwise selection in R<a href="variable-selection-process.html#implementation-of-stepwise-selection-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Jupyter notebook (R kernel) Stats 191 at Stanford. This one uses cross-validation on the <strong>stepwise procedures</strong>, and demonstrates the dangers of trusting models that come out of blind use of variable selection methods. <a href="https://web.stanford.edu/class/stats191/notebooks/Selection.html" class="uri">https://web.stanford.edu/class/stats191/notebooks/Selection.html</a></li>
<li><strong>Best Subsets</strong> from STDHA: <a href="http://www.sthda.com/english/articles/37-model-selection-essentials-in-r/155-best-subsets-regression-essentials-in-r/" class="uri">http://www.sthda.com/english/articles/37-model-selection-essentials-in-r/155-best-subsets-regression-essentials-in-r/</a></li>
</ul>
</div>
<div id="lasso-regression-pma6-9.7" class="section level3 hasAnchor" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> LASSO Regression (PMA6 9.7)<a href="variable-selection-process.html#lasso-regression-pma6-9.7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>L</strong>east <strong>A</strong>bsolute <strong>S</strong>hrinkage and <strong>S</strong>election <strong>O</strong>perator.</p>
<p>The goal of LASSO is to minimize</p>
<p><span class="math display">\[
RSS + \lambda \sum_{j}\mid \beta_{j} \ \mid
\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> is a model complexity penalty parameter.</p>
<ul>
<li>âShrinksâ the coefficients, setting some to exactly 0.
<ul>
<li>Thus essentially choosing a simpler model</li>
</ul></li>
<li>Balances model accuracy with interpretation.</li>
</ul>
<p>The lasso fits many regression models and selects those variables that show the strongest association with the response variable using the data at hand. This is also described as a method of <em>selective inference</em> (Taylor and Tibshirani, 2015) and is an example of exploratory research, where the data may influence what type and how many analyses are performed.</p>
<div id="example-1" class="section level4 hasAnchor" number="10.4.3.1">
<h4><span class="header-section-number">10.4.3.1</span> Example<a href="variable-selection-process.html#example-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>

<div class="rmdnote">
This section uses functions <code>glmnet</code> package, and the <code>Chemical</code> data set from PMA6. Also it uses the <code>model.matrix</code> function from the <code>stats</code> package (automatically loaded). This function takes a set of input predictors and turns them into the variables that are used directly in the model. For example, categorical variables will be converted into multiple binary indicators. This typically happens in the background.
</div>
<p>The <code>glmnet</code> function works best when the outcome <code>y</code> and predictors <code>x</code> are not contained within a data frame. The <code>alpha</code> argument is the tuning parameter, where a value of 1 specifies the lasso.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="variable-selection-process.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb201-2"><a href="variable-selection-process.html#cb201-2" aria-hidden="true" tabindex="-1"></a>chem <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/Chemical.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb201-3"><a href="variable-selection-process.html#cb201-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> chem<span class="sc">$</span>PE</span>
<span id="cb201-4"><a href="variable-selection-process.html#cb201-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(PE<span class="sc">~</span>., chem)[,<span class="sc">-</span><span class="dv">1</span>] <span class="co"># the -1 drops the intercept</span></span>
<span id="cb201-5"><a href="variable-selection-process.html#cb201-5" aria-hidden="true" tabindex="-1"></a>chem.lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>We can visualize the effect of the coefficient shrinkage using the following plot.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="variable-selection-process.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(chem.lasso, <span class="at">xvar =</span> <span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb202-2"><a href="variable-selection-process.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="st">&quot;Number of Variables&quot;</span>, <span class="at">line=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="model_building_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<ul>
<li>Each line represents the value of a coefficient as <span class="math inline">\(ln(\lambda)\)</span> changes.</li>
<li>The red line on the bottom and the purple on the top must be important, since they are the last two to be shrunk to 0 and they are relatively stable.</li>
</ul>
<p>Examining the coefficients of the <code>chem.lasso</code> model object gives us a very large matrix (7x61), listing the coefficients for each value of <span class="math inline">\(\lambda\)</span> that was tried. A sample of columns are shown below:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="variable-selection-process.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(chem.lasso)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb203-2"><a href="variable-selection-process.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 7 x 8 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb203-3"><a href="variable-selection-process.html#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="do">##                   s0         s1         s2        s3       s4         s5</span></span>
<span id="cb203-4"><a href="variable-selection-process.html#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 9.366667  9.5835968  9.7812554  9.961355 10.12545 10.0399324</span></span>
<span id="cb203-5"><a href="variable-selection-process.html#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ROR5        .         .          .          .         .        .        </span></span>
<span id="cb203-6"><a href="variable-selection-process.html#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="do">## DE          .        -0.5206322 -0.9950129 -1.427251 -1.82109 -2.0903355</span></span>
<span id="cb203-7"><a href="variable-selection-process.html#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="do">## SALESGR5    .         .          .          .         .        .        </span></span>
<span id="cb203-8"><a href="variable-selection-process.html#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="do">## EPS5        .         .          .          .         .        .        </span></span>
<span id="cb203-9"><a href="variable-selection-process.html#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="do">## NPM1        .         .          .          .         .        0.0157436</span></span>
<span id="cb203-10"><a href="variable-selection-process.html#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="do">## PAYOUTR1    .         .          .          .         .        0.2427377</span></span>
<span id="cb203-11"><a href="variable-selection-process.html#cb203-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                      s6          s7</span></span>
<span id="cb203-12"><a href="variable-selection-process.html#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  9.59940208  9.19800729</span></span>
<span id="cb203-13"><a href="variable-selection-process.html#cb203-13" aria-hidden="true" tabindex="-1"></a><span class="do">## ROR5         .           .         </span></span>
<span id="cb203-14"><a href="variable-selection-process.html#cb203-14" aria-hidden="true" tabindex="-1"></a><span class="do">## DE          -2.21050375 -2.31999666</span></span>
<span id="cb203-15"><a href="variable-selection-process.html#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="do">## SALESGR5     .           .         </span></span>
<span id="cb203-16"><a href="variable-selection-process.html#cb203-16" aria-hidden="true" tabindex="-1"></a><span class="do">## EPS5         .           .         </span></span>
<span id="cb203-17"><a href="variable-selection-process.html#cb203-17" aria-hidden="true" tabindex="-1"></a><span class="do">## NPM1         0.04642112  0.07437333</span></span>
<span id="cb203-18"><a href="variable-selection-process.html#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="do">## PAYOUTR1     0.98609790  1.66341998</span></span>
<span id="cb203-19"><a href="variable-selection-process.html#cb203-19" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(chem.lasso)[,<span class="dv">56</span><span class="sc">:</span><span class="dv">60</span>]</span>
<span id="cb203-20"><a href="variable-selection-process.html#cb203-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 7 x 5 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb203-21"><a href="variable-selection-process.html#cb203-21" aria-hidden="true" tabindex="-1"></a><span class="do">##                     s55         s56         s57         s58         s59</span></span>
<span id="cb203-22"><a href="variable-selection-process.html#cb203-22" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  1.36957827  1.35834023  1.34802448  1.34099610  1.33052382</span></span>
<span id="cb203-23"><a href="variable-selection-process.html#cb203-23" aria-hidden="true" tabindex="-1"></a><span class="do">## ROR5         0.03767492  0.03797214  0.03825501  0.03840313  0.03870172</span></span>
<span id="cb203-24"><a href="variable-selection-process.html#cb203-24" aria-hidden="true" tabindex="-1"></a><span class="do">## DE          -2.58475249 -2.58199893 -2.57937377 -2.57863116 -2.57530747</span></span>
<span id="cb203-25"><a href="variable-selection-process.html#cb203-25" aria-hidden="true" tabindex="-1"></a><span class="do">## SALESGR5     0.19961031  0.19990639  0.20017553  0.20039468  0.20064382</span></span>
<span id="cb203-26"><a href="variable-selection-process.html#cb203-26" aria-hidden="true" tabindex="-1"></a><span class="do">## EPS5        -0.03468051 -0.03483069 -0.03497088 -0.03507850 -0.03520342</span></span>
<span id="cb203-27"><a href="variable-selection-process.html#cb203-27" aria-hidden="true" tabindex="-1"></a><span class="do">## NPM1         0.34740236  0.34760738  0.34778861  0.34795977  0.34812027</span></span>
<span id="cb203-28"><a href="variable-selection-process.html#cb203-28" aria-hidden="true" tabindex="-1"></a><span class="do">## PAYOUTR1     9.78594052  9.79286717  9.79910767  9.80408094  9.81009965</span></span></code></pre></div>
<p>Comparing the plot to the coefficient model output above, we see that the variables that show up being shrunk last are <code>DE</code> and <code>PAYOUTR1</code>.</p>
<p><strong>Using Cross validation to find minimum lambda</strong></p>
<p>Cross-validation is a resampling method that uses different portions of the data to test and train a model on different iterations <a href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)">Wikipedia</a>.</p>
<p>By applying a cross-validation technique, we can identify the specific value for <span class="math inline">\(\lambda\)</span> that
results in the lowest cross-validated Mean Squared Error (MSE) (<span class="math inline">\(\lambda_{min}\)</span>). To ensure
reproducibility of these results we set a seed for the random number generator prior to analysis.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="variable-selection-process.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># Setting a seed to ensure I get the same results each time I knit</span></span>
<span id="cb204-2"><a href="variable-selection-process.html#cb204-2" aria-hidden="true" tabindex="-1"></a>cv.lasso <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="co"># note change in function</span></span>
<span id="cb204-3"><a href="variable-selection-process.html#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="variable-selection-process.html#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the final model using the min lambda</span></span>
<span id="cb204-5"><a href="variable-selection-process.html#cb204-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> cv.lasso<span class="sc">$</span>lambda.min)</span></code></pre></div>
<p>The resulting table of shrunk regression coefficients then is;</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="variable-selection-process.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span>
<span id="cb205-2"><a href="variable-selection-process.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 7 x 1 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb205-3"><a href="variable-selection-process.html#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="do">##                       s0</span></span>
<span id="cb205-4"><a href="variable-selection-process.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  2.645693621</span></span>
<span id="cb205-5"><a href="variable-selection-process.html#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ROR5         0.004833458</span></span>
<span id="cb205-6"><a href="variable-selection-process.html#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="do">## DE          -2.882636490</span></span>
<span id="cb205-7"><a href="variable-selection-process.html#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="do">## SALESGR5     0.165581782</span></span>
<span id="cb205-8"><a href="variable-selection-process.html#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="do">## EPS5        -0.017771193</span></span>
<span id="cb205-9"><a href="variable-selection-process.html#cb205-9" aria-hidden="true" tabindex="-1"></a><span class="do">## NPM1         0.323497141</span></span>
<span id="cb205-10"><a href="variable-selection-process.html#cb205-10" aria-hidden="true" tabindex="-1"></a><span class="do">## PAYOUTR1     8.986481946</span></span></code></pre></div>
<p>In this case we would keep variables: DE, SALESGR5, NPM1 and PAYOUTR1. Estimates for ROR5 and EPS56 are very small, and so can be reasonably excluded.</p>
<ul>
<li>The lasso procedure normalizes the data prior to fitting a model, so the coefficient values that are returned <em>cannot</em> be interpreted directly in context of the problem.
<ul>
<li>This does allow us the ability to make âjudgementâ calls on what is a âsmallâ estimate since itâs no longer dependent on the units of the data.</li>
</ul></li>
<li>Appropriate inference after model selection is currently under research. No unifying theory exists yet.</li>
<li>For now, use lasso to choose variables, then fit a model with only those selected variables in the final model.</li>
<li>Variables chosen in this manner are important, yet biased estimates.</li>
</ul>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="variable-selection-process.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(PE <span class="sc">~</span> DE <span class="sc">+</span> SALESGR5 <span class="sc">+</span> NPM1 <span class="sc">+</span> PAYOUTR1, <span class="at">data =</span> chem) <span class="sc">|&gt;</span> <span class="fu">tbl_regression</span>()</span></code></pre></div>
<div id="iijwugufyb" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#iijwugufyb .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iijwugufyb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iijwugufyb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iijwugufyb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iijwugufyb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iijwugufyb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iijwugufyb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iijwugufyb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iijwugufyb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iijwugufyb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iijwugufyb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iijwugufyb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#iijwugufyb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iijwugufyb .gt_from_md > :first-child {
  margin-top: 0;
}

#iijwugufyb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iijwugufyb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iijwugufyb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iijwugufyb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iijwugufyb .gt_row_group_first td {
  border-top-width: 2px;
}

#iijwugufyb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iijwugufyb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iijwugufyb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iijwugufyb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iijwugufyb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iijwugufyb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iijwugufyb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iijwugufyb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iijwugufyb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iijwugufyb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iijwugufyb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iijwugufyb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iijwugufyb .gt_left {
  text-align: left;
}

#iijwugufyb .gt_center {
  text-align: center;
}

#iijwugufyb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iijwugufyb .gt_font_normal {
  font-weight: normal;
}

#iijwugufyb .gt_font_bold {
  font-weight: bold;
}

#iijwugufyb .gt_font_italic {
  font-style: italic;
}

#iijwugufyb .gt_super {
  font-size: 65%;
}

#iijwugufyb .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#iijwugufyb .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#iijwugufyb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iijwugufyb .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#iijwugufyb .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#iijwugufyb .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>95% CI</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">DE</td>
<td class="gt_row gt_center">-3.2</td>
<td class="gt_row gt_center">-6.9, 0.58</td>
<td class="gt_row gt_center">0.094</td></tr>
    <tr><td class="gt_row gt_left">SALESGR5</td>
<td class="gt_row gt_center">0.19</td>
<td class="gt_row gt_center">-0.02, 0.41</td>
<td class="gt_row gt_center">0.077</td></tr>
    <tr><td class="gt_row gt_left">NPM1</td>
<td class="gt_row gt_center">0.35</td>
<td class="gt_row gt_center">0.12, 0.59</td>
<td class="gt_row gt_center">0.005</td></tr>
    <tr><td class="gt_row gt_left">PAYOUTR1</td>
<td class="gt_row gt_center">11</td>
<td class="gt_row gt_center">4.7, 17</td>
<td class="gt_row gt_center">0.001</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<div id="ridge-regression-pma6-10.6" class="section level4 hasAnchor" number="10.4.3.2">
<h4><span class="header-section-number">10.4.3.2</span> Ridge Regression (PMA6 10.6)<a href="variable-selection-process.html#ridge-regression-pma6-10.6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Often compared to LASSO, Ridge regression also minimizes the RSS, but the penalty function is different:
<span class="math display">\[
RSS + \lambda \sum_{j} \beta_{j}^2
\]</span></p>
<p>Ridge regression only shrinks the magnitude of the coefficients, not set them exactly to zero.</p>

<div class="rmdwarning">
This means Ridge regression is <strong>not</strong> a method of variable selection.
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multicollinearity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-fit-criteria.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
